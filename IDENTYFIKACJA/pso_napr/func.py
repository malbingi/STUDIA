from math import pow, cos, pi, exp
import numpy as np
from numba import jit
    
def sigma_p(vector_a, epsilon, epsilon_dot, Temp):
    W = exp(-vector_a[6]*epsilon)
    exp_a4 = exp(vector_a[3]/(8.314*(Temp+273)))
    exp_a6 = exp(vector_a[5]/(8.314*(Temp+273)))
    e_dot_a3 = pow(epsilon_dot, vector_a[2])
    e_a2 = pow(epsilon, vector_a[1])
    return e_dot_a3 * (W * vector_a[0] * e_a2 * exp_a4  +  (1-W) * vector_a[4] * exp_a6)

def square_error(vector_a):
    returned_value = 0.0
    for i in range(9):
        T, epsilon_dot = dict_T_epsilon_dot[i]
        for j in range(20):
            exp = np.longdouble(dict_experiment_sigma[i][j])
            value = (exp-sigma_p(vector_a, 0.05*(j+1), epsilon_dot, T))/exp
            returned_value = returned_value + pow(value, 2)
    return returned_value

# zwraca parę wartości (Temperatura, prędkość odkształcenia)
dict_T_epsilon_dot = {
    0: [850.0, 0.1],
    1: [850.0, 1.0],
    2: [850.0, 10.0],
    3: [1000.0, 0.1],
    4: [1000.0, 1.0],
    5: [1000.0, 10.0],
    6: [1150.0, 0.1],
    7: [1150.0, 1.0],
    8: [1150.0, 10.0]
}

dict_experiment_sigma = {
    0: [
108.5036276,
122.0488161,
129.30944,
133.6855745,
136.3664309,
137.9247088,
138.6856729,
138.8540333,
138.5680192,
137.9258708,
137.0001695,
135.846189,
134.5070525,
133.017072,
131.4039937,
129.6905585,
127.8956172,
126.0349449,
124.1218502,
122.1676378,
], 
    1: [
143.6958608,
161.6343164,
171.2498623,
177.045359,
180.5957285,
182.6594207,
183.6671969,
183.8901636,
183.5113833,
182.6609595,
181.4350148,
179.9067504,
178.1332764,
176.1600334,
174.0237667,
171.7545934,
169.377478,
166.9133124,
164.3797216,
161.791677,
],
    2: [
190.3023968,
214.0590388,
226.7933056,
234.4685225,
239.1704243,
241.9034576,
243.2380975,
243.5333815,
243.031747,
241.9054955,
240.2819261,
238.2579821,
235.9092968,
233.296049,
230.4669023,
227.4617419,
224.3136292,
221.0502324,
217.6948929,
214.2674379,
],
    3: [
102.4895071,
115.2824501,
122.1391127,
126.2711639,
128.8019177,
130.2723381,
130.9896651,
131.1472645,
130.8757049,
130.2677819,
129.3920539,
128.3007308,
127.0345456,
125.6259079,
124.1010256,
122.4813788,
120.7847726,
119.0261075,
117.2179536,
115.3709886,
],
    4: [
135.7311112,
152.673337,
161.7539,
167.2261471,
170.5777294,
172.5250683,
173.4750542,
173.6837696,
173.324132,
172.5190342,
171.3592713,
169.9139868,
168.2371252,
166.3716078,
164.3521428,
162.2071772,
159.9602912,
157.6312179,
155.2366047,
152.7905921,
],
    5: [
179.7543482,
202.1916414,
214.2174082,
221.4645323,
225.9031721,
228.4821138,
229.7402196,
230.0166301,
229.5403471,
228.4741226,
226.9382004,
225.0241502,
222.8034126,
220.3328305,
217.6583691,
214.8177021,
211.8420576,
208.7575691,
205.5862833,
202.3469274,
],
    6: [
97.97966211,
110.2086495,
116.7625316,
120.7116914,
123.1300262,
124.5347016,
125.2194409,
125.369103,
125.1085117,
124.5263797,
123.688249,
122.6440318,
121.4326687,
120.0851429,
118.6265088,
117.0773009,
115.4545406,
113.7724722,
112.0431124,
110.2766685,
],
    7: [
129.7585361,
145.9538921,
154.6334703,
159.8635067,
163.0662079,
164.9264779,
165.8333067,
166.0315103,
165.6863984,
164.9154569,
163.8054855,
162.4225854,
160.8183269,
159.0337426,
157.1020128,
155.0503325,
152.9012436,
150.6736105,
148.3833475,
146.0439724,
],
    8: [
171.844619,
193.2928015,
204.7875274,
211.7138819,
215.9553521,
218.4189849,
219.6199359,
219.8824252,
219.4253793,
218.4043893,
216.9344081,
215.1029761,
212.9783899,
210.6149908,
208.0567208,
205.3395953,
202.4934677,
199.5433206,
196.5102302,
193.4120986,
],
}